<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Botball å™¨ææ£€æŸ¥å™¨ 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #e8e6e1;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #f5f3ef;
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
        }

        .header {
            background: #f5f3ef;
            color: #1a1a1a;
            padding: 40px 30px 20px;
            text-align: left;
            border-bottom: 4px solid #1a1a1a;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 5px;
            font-weight: 900;
            letter-spacing: -1px;
            text-transform: uppercase;
        }

        .header p {
            font-size: 1em;
            opacity: 0.6;
            margin-top: 5px;
            font-weight: 400;
        }

        .tabs {
            display: flex;
            background: #f5f3ef;
            border-bottom: 1px solid #d0cdc7;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            background: transparent;
            color: #666;
            letter-spacing: 0.5px;
        }

        .tab:hover {
            background: #ebe9e5;
            color: #1a1a1a;
        }

        .tab.active {
            background: #1a1a1a;
            color: white;
            border-bottom: none;
        }

        .content {
            padding: 30px;
            background: #f5f3ef;
        }

        .category {
            margin-bottom: 40px;
        }

        .category-header {
            background: #1a1a1a;
            color: white;
            padding: 12px 20px;
            border-radius: 0;
            margin-bottom: 20px;
            font-size: 1.1em;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .parts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .part-card {
            background: white;
            border-radius: 2px;
            padding: 20px;
            border: 1px solid #d0cdc7;
            transition: all 0.3s;
            border-left: 4px solid #1a1a1a;
        }

        .part-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        .part-card.over-limit {
            border-left-color: #c41e3a;
            background: #fff5f5;
        }

        .part-name {
            font-size: 1em;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1a1a1a;
            letter-spacing: 0.3px;
        }

        .part-info {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .robot-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .input-group label {
            min-width: 80px;
        }

        .number-control {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-number {
            width: 32px;
            height: 32px;
            border: 2px solid #1a1a1a;
            background: white;
            color: #1a1a1a;
            border-radius: 0;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
        }

        .btn-number:hover {
            background: #1a1a1a;
            color: white;
            transform: scale(1.05);
        }

        .btn-number:active {
            transform: scale(0.95);
        }

        .input-group input {
            width: 60px;
            padding: 6px 8px;
            border: 2px solid #d0cdc7;
            border-radius: 0;
            font-size: 1em;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }

        .input-group input:focus {
            outline: none;
            border-color: #1a1a1a;
        }

        .usage-info {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: white;
            border-radius: 5px;
            font-size: 0.9em;
        }

        .usage-info.over {
            background: #c41e3a;
            color: white;
            font-weight: 700;
        }

        .summary {
            position: sticky;
            top: 20px;
            background: white;
            color: #1a1a1a;
            padding: 30px;
            border-radius: 0;
            margin-bottom: 30px;
            border: 1px solid #d0cdc7;
            border-left: 4px solid #c41e3a;
        }

        .summary h2 {
            margin-bottom: 25px;
            font-size: 1.3em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            border-top: 1px solid #e0ddd8;
            padding-top: 20px;
        }

        .stat-card {
            background: transparent;
            padding: 0;
            border-radius: 0;
            text-align: center;
            border-right: 1px solid #e0ddd8;
        }

        .stat-card:last-child {
            border-right: none;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 900;
            margin-bottom: 5px;
            color: #1a1a1a;
        }

        .stat-label {
            font-size: 0.85em;
            opacity: 0.6;
            font-weight: 500;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: 2px solid #1a1a1a;
            border-radius: 0;
            font-size: 0.9em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .btn-primary {
            background: #1a1a1a;
            color: white;
            border-color: #1a1a1a;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary {
            background: white;
            color: #1a1a1a;
            border-color: #1a1a1a;
        }

        .btn-secondary:hover {
            background: #1a1a1a;
            color: white;
        }

        .btn-danger {
            background: white;
            color: #c41e3a;
            border-color: #c41e3a;
        }

        .btn-danger:hover {
            background: #c41e3a;
            color: white;
        }

        .btn-warning {
            background: white;
            color: #1a1a1a;
            border-color: #1a1a1a;
        }

        .btn-warning:hover {
            background: #1a1a1a;
            color: white;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 12px 20px;
            border: 2px solid #d0cdc7;
            border-radius: 0;
            font-size: 1em;
            background: white;
        }

        .search-box:focus {
            outline: none;
            border-color: #1a1a1a;
        }

        @media (max-width: 768px) {
            .parts-grid {
                grid-template-columns: 1fr;
            }

            .summary-stats {
                grid-template-columns: 1fr;
            }

            .robot-inputs {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }
        }

        .hidden {
            display: none;
        }

        .pdf-links {
            background: white;
            padding: 20px;
            border-radius: 0;
            margin-bottom: 20px;
            box-shadow: none;
            border: 1px solid #d0cdc7;
            border-left: 4px solid #1a1a1a;
        }

        .pdf-links h3 {
            margin: 0 0 20px 0;
            color: #1a1a1a;
            font-size: 1.1em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .pdf-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .pdf-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            border: 2px solid #d0cdc7;
            border-radius: 0;
            text-decoration: none;
            transition: all 0.2s;
            background: #f5f3ef;
        }

        .pdf-card:hover {
            border-color: #1a1a1a;
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }

        .pdf-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .pdf-title {
            font-size: 1em;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 5px;
        }

        .pdf-desc {
            font-size: 0.85em;
            color: #666;
        }

        .search-result-badge {
            display: inline-block;
            padding: 2px 8px;
            margin-left: 8px;
            background: #1a1a1a;
            color: white;
            border-radius: 0;
            font-size: 0.75em;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .team-info {
            background: white;
            padding: 20px;
            border-radius: 0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: none;
            border: 1px solid #d0cdc7;
            border-left: 4px solid #1a1a1a;
        }

        .team-info label {
            font-weight: 700;
            color: #1a1a1a;
            font-size: 1em;
            letter-spacing: 0.3px;
        }

        .team-info input {
            flex: 1;
            max-width: 300px;
            padding: 10px 15px;
            border: 2px solid #d0cdc7;
            border-radius: 0;
            font-size: 1em;
            background: white;
        }

        .team-info input:focus {
            outline: none;
            border-color: #1a1a1a;
        }

        .btn-print {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-print:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        @media print {
            * {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            body {
                background: white;
                margin: 0;
                padding: 10px;
            }

            .container {
                box-shadow: none;
                max-width: 100%;
                margin: 0;
                padding: 0;
            }

            .header {
                background: white !important;
                color: #333 !important;
                padding: 10px 0 5px 0 !important;
                text-align: left !important;
            }

            .header h1 {
                font-size: 1.2em !important;
                margin: 0 0 3px 0 !important;
                display: inline-block;
            }

            .header p {
                display: none !important;
            }

            .tabs, .controls, .btn, .search-box {
                display: none !important;
            }

            .content {
                padding: 5px 0 !important;
            }

            .team-info {
                padding: 5px 0 !important;
                margin-bottom: 8px !important;
                border: none !important;
                box-shadow: none !important;
            }

            .team-info label {
                font-size: 0.9em !important;
            }

            .team-info input {
                border: none !important;
                padding: 0 5px !important;
                font-weight: bold;
            }

            .summary {
                background: white !important;
                color: #333 !important;
                border: 1px solid #333;
                padding: 4px 8px !important;
                margin-bottom: 8px !important;
                position: static !important;
                display: flex !important;
                align-items: center !important;
                gap: 15px !important;
                clear: both !important;
                page-break-after: avoid !important;
            }

            .summary h2 {
                font-size: 0.9em !important;
                margin: 0 !important;
                display: inline-block !important;
            }

            .summary-stats {
                display: flex !important;
                gap: 15px !important;
                font-size: 0.8em !important;
                flex: 1 !important;
                grid-template-columns: none !important;
            }

            .stat-card {
                background: transparent !important;
                color: #333 !important;
                padding: 0 !important;
                display: inline-flex !important;
                align-items: center !important;
                gap: 5px !important;
            }

            .stat-number {
                font-size: 1.1em !important;
                margin: 0 !important;
                font-weight: bold !important;
            }

            .stat-label {
                font-size: 0.85em !important;
            }

            .kit-content {
                clear: both !important;
                page-break-before: avoid !important;
            }

            .category {
                margin-bottom: 6px !important;
                page-break-inside: avoid;
            }

            .category-header {
                background: #333 !important;
                color: white !important;
                padding: 3px 6px !important;
                font-size: 0.85em !important;
                margin-bottom: 4px !important;
            }

            .category.all-unused {
                display: none !important;
            }

            .parts-grid {
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 5px !important;
            }

            .part-card {
                padding: 4px 5px !important;
                margin: 0 !important;
                page-break-inside: avoid;
                font-size: 0.75em !important;
                border: 1px solid #ddd !important;
            }

            .part-card.unused {
                display: none !important;
            }

            .part-header {
                display: none !important;
            }

            .part-image {
                display: none !important;
            }

            .part-name {
                font-size: 0.85em !important;
                margin-bottom: 2px !important;
                font-weight: 600 !important;
                line-height: 1.2 !important;
            }

            .part-info {
                font-size: 0.75em !important;
                margin-bottom: 2px !important;
                color: #666 !important;
            }

            .robot-inputs {
                display: flex !important;
                gap: 5px !important;
                margin-bottom: 2px !important;
            }

            .input-group {
                flex: 1 !important;
                font-size: 0.75em !important;
                display: flex !important;
                align-items: center !important;
                gap: 2px !important;
            }

            .input-group label {
                min-width: 50px !important;
                font-size: 0.8em !important;
            }

            .number-control {
                display: none !important;
            }

            .btn-number {
                display: none !important;
            }

            .input-group input {
                width: 25px !important;
                padding: 1px 2px !important;
                font-size: 0.85em !important;
                border: 1px solid #333 !important;
                text-align: center !important;
                font-weight: bold !important;
            }

            .usage-info {
                padding: 2px 4px !important;
                font-size: 0.7em !important;
                background: #f8f9fa !important;
                display: flex !important;
                justify-content: space-between !important;
            }

            .usage-info.over {
                background: #ffebee !important;
                color: #d32f2f !important;
                border: 1px solid #d32f2f !important;
                font-weight: bold !important;
            }

            .hidden {
                display: block !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Botball å™¨ææ£€æŸ¥å™¨ 2026</h1>
            <p>è·Ÿè¸ªä¸¤ä¸ªæœºå™¨äººçš„é›¶ä»¶ä½¿ç”¨æƒ…å†µï¼Œç¡®ä¿ç¬¦åˆè§„åˆ™</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-kit="electronics">ç”µå­å¥—ä»¶</button>
            <button class="tab" data-kit="metal">é‡‘å±é›¶ä»¶</button>
            <button class="tab" data-kit="lego">ä¹é«˜é›¶ä»¶</button>
        </div>

        <div class="content">
            <div class="team-info">
                <label for="teamNumber">ğŸ† é˜Ÿä¼ç¼–å·:</label>
                <input type="text" id="teamNumber" placeholder="è¯·è¾“å…¥é˜Ÿä¼ç¼–å·..." onchange="saveTeamNumber()">
            </div>

            <div class="summary">
                <h2>ğŸ“Š ä½¿ç”¨ç»Ÿè®¡</h2>
                <div class="summary-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalParts">0</div>
                        <div class="stat-label">æ€»é›¶ä»¶ç±»å‹</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="usedParts">0</div>
                        <div class="stat-label">å·²ä½¿ç”¨ç±»å‹</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="overLimitParts">0</div>
                        <div class="stat-label">è¶…è§„é›¶ä»¶</div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <input type="text" class="search-box" id="searchBox" placeholder="ğŸ” æœç´¢é›¶ä»¶åç§°ï¼ˆæœç´¢å…¨éƒ¨å¥—ä»¶ï¼‰..." oninput="searchAllKits()">
                <button class="btn btn-print" onclick="printReport()">ğŸ–¨ï¸ æ‰“å°</button>
                <button class="btn btn-primary" onclick="togglePDFLinks()">ğŸ“‹ æŸ¥çœ‹æ¸…å•PDF</button>
                <button class="btn btn-warning" onclick="clearCurrentKit()">ğŸ§¹ æ¸…ç©ºå½“å‰å¥—ä»¶</button>
                <button class="btn btn-secondary" onclick="exportData()">ğŸ’¾ å¯¼å‡ºæ•°æ®</button>
                <button class="btn btn-secondary" onclick="importData()">ğŸ“¥ å¯¼å…¥æ•°æ®</button>
                <button class="btn btn-danger" onclick="resetAll()">ğŸ”„ é‡ç½®æ‰€æœ‰</button>
            </div>

            <div id="pdfLinks" class="pdf-links hidden">
                <h3>ğŸ“‹ å®˜æ–¹å¥—ä»¶æ¸…å•PDF</h3>
                <div class="pdf-grid">
                    <a href="pdfs/2026 Electronics Kit.pdf" target="_blank" class="pdf-card">
                        <span class="pdf-icon">ğŸ“¦</span>
                        <span class="pdf-title">ç”µå­å¥—ä»¶æ¸…å•</span>
                        <span class="pdf-desc">2026 Electronics Kit</span>
                    </a>
                    <a href="pdfs/2026 KIPR Metal Parts.pdf" target="_blank" class="pdf-card">
                        <span class="pdf-icon">ğŸ”§</span>
                        <span class="pdf-title">é‡‘å±é›¶ä»¶æ¸…å•</span>
                        <span class="pdf-desc">2026 KIPR Metal Parts</span>
                    </a>
                    <a href="pdfs/2026 Lego Parts.pdf" target="_blank" class="pdf-card">
                        <span class="pdf-icon">ğŸ§±</span>
                        <span class="pdf-title">ä¹é«˜é›¶ä»¶æ¸…å•</span>
                        <span class="pdf-desc">2026 Lego Parts</span>
                    </a>
                </div>
            </div>

            <div id="electronicsKit" class="kit-content"></div>
            <div id="metalKit" class="kit-content hidden"></div>
            <div id="legoKit" class="kit-content hidden"></div>
        </div>
    </div>

    <input type="file" id="fileInput" accept=".json" style="display: none;">

    <script>
        const kitsData = {
            electronics: {
                "ä¼ æ„Ÿå™¨ - æ¨¡æ‹Ÿ": [
                    { name: "ET (æµ‹è·ä¼ æ„Ÿå™¨)", limit: 2 },
                    { name: "Tophat (åå°„ä¼ æ„Ÿå™¨)", limit: 4 },
                    { name: "Small Tophat (å°å‹åå°„ä¼ æ„Ÿå™¨)", limit: 2 },
                    { name: "Light (å…‰çº¿ä¼ æ„Ÿå™¨)", limit: 3 },
                    { name: "Linear Slide (çº¿æ€§æ»‘å—)", limit: 1 }
                ],
                "ä¼ æ„Ÿå™¨ - æ•°å­—": [
                    { name: "Lever (æ æ†ä¼ æ„Ÿå™¨)", limit: 2 },
                    { name: "Small Touch (å°è§¦ç¢°ä¼ æ„Ÿå™¨)", limit: 4 },
                    { name: "Large Touch (å¤§è§¦ç¢°ä¼ æ„Ÿå™¨)", limit: 6 }
                ],
                "è¿åŠ¨éƒ¨ä»¶": [
                    { name: "Servo (èˆµæœº)", limit: 5 },
                    { name: "Black Gear Motor (é»‘è‰²é½¿è½®ç”µæœº)", limit: 8 },
                    { name: "Micro Servo (å¾®å‹èˆµæœº)", limit: 2 }
                ],
                "æ§åˆ¶å™¨": [
                    { name: "Wombat (æ§åˆ¶å™¨)", limit: 2 }
                ],
                "å…¶ä»–é…ä»¶": [
                    { name: "Black Camera (æ‘„åƒå¤´)", limit: 1 },
                    { name: "Wombat Battery Charger (ç”µæ± å……ç”µå™¨)", limit: 2 },
                    { name: "Wombat Battery (ç”µæ± )", limit: 2 },
                    { name: "Servo Extension Cable (èˆµæœºå»¶é•¿çº¿)", limit: 3 },
                    { name: "Sensor Extension Cable (ä¼ æ„Ÿå™¨å»¶é•¿çº¿)", limit: 2 },
                    { name: "Solarbotics Wheel (è½®å­)", limit: 4 },
                    { name: "Mecanum Wheel (éº¦è½®)", limit: 4 }
                ]
            },
            metal: {
                "KIPR é‡‘å±ä»¶": [
                    { name: "Strap 1 x 19 (å¸¦å­”æ¡ 1x19)", limit: 4, bendable: true },
                    { name: "Strap 1 x 10 (å¸¦å­”æ¡ 1x10)", limit: 6, bendable: true },
                    { name: "Channel 3 x 8 (é€šé“ 3x8)", limit: 3 },
                    { name: "Channel 3 x 12 (é€šé“ 3x12)", limit: 2 },
                    { name: "Channel 3 x 16 (é€šé“ 3x16)", limit: 1 },
                    { name: "Plate 4 x 12 (æ¿ 4x12)", limit: 4, bendable: true },
                    { name: "Chassis (åº•ç›˜)", limit: 2 },
                    { name: "D Bracket (Då‹æ”¯æ¶)", limit: 1 },
                    { name: "Angle Bracket (è§’æ”¯æ¶)", limit: 2 },
                    { name: "Plus Plate (åå­—æ¿)", limit: 1, bendable: true },
                    { name: "Servo Bracket (èˆµæœºæ”¯æ¶)", limit: 8 },
                    { name: "Round Servo Horn (åœ†å½¢èˆµç›˜)", limit: 2 },
                    { name: "1 x 5 Servo Horn (1x5èˆµç›˜)", limit: 4 },
                    { name: "Micro Servo Mount (å¾®å‹èˆµæœºåº§)", limit: 2 }
                ],
                "èºä¸ã€èºæ¯å’Œç«‹æŸ±": [
                    { name: "Screw 8-32 x 1/4\" (èºä¸)", limit: 40 },
                    { name: "Screw 8-32 x 1/2\" (èºä¸)", limit: 90 },
                    { name: "Screw 8-32 x 3/4\" (èºä¸)", limit: 70 },
                    { name: "Nut 8-32 Keps (èºæ¯)", limit: 170 },
                    { name: "Nut 8-32 Nylock (è‡ªé”èºæ¯)", limit: 30 },
                    { name: "Standoff 8-32 x 1/2\" (ç«‹æŸ±)", limit: 12 },
                    { name: "Standoff 8-32 x 1\" (ç«‹æŸ±)", limit: 7 },
                    { name: "Standoff 8-32 x 2\" (ç«‹æŸ±)", limit: 2 },
                    { name: "Standoff 8-32 x 3\" (ç«‹æŸ±)", limit: 1 },
                    { name: "Short Silver Servo Horn Screw M3 (èˆµç›˜èºä¸)", limit: 6 },
                    { name: "18-8 Washer (å«åœˆ)", limit: 6 },
                    { name: "Silver Servo Horn Nut M3 (èˆµç›˜èºæ¯)", limit: 10 },
                    { name: "Silver Servo Horn Machine Screw M3 (èˆµç›˜æœºèºä¸)", limit: 10 },
                    { name: "Threaded Rod 8-32 x 1\" (èºçº¹æ†)", limit: 10 },
                    { name: "Threaded Rod 8-32 x 2\" (èºçº¹æ†)", limit: 2 },
                    { name: "Threaded Rod 8-32 x 3\" (èºçº¹æ†)", limit: 2 },
                    { name: "Threaded Rod 8-32 x 6\" (èºçº¹æ†)", limit: 1 },
                    { name: "Brass Screws (é»„é“œèºä¸)", limit: 10 },
                    { name: "2-56 1\" Caster Screw (ä¸‡å‘è½®èºä¸)", limit: 5 },
                    { name: "2-56 3/8\" Micro Servo Mount Screw (å¾®èˆµæœºåº§èºä¸)", limit: 6 },
                    { name: "M3 x 0.5\" x 6\" Mecanum Wheel Screw (éº¦è½®èºä¸)", limit: 6 }
                ],
                "å…¶ä»–": [
                    { name: "Caster (ä¸‡å‘è½®)", limit: 2 }
                ]
            },
            lego: {
                "è½´ (Axles)": [
                    { name: "#2 Axle (32062)", limit: 32 },
                    { name: "#3 Axle (4519)", limit: 48 },
                    { name: "#3 Axle w/ stud (6587)", limit: 4 },
                    { name: "#4 Axle (3705)", limit: 16 },
                    { name: "#4 Axle w/ stop (87083)", limit: 4 },
                    { name: "#5 Axle (32073)", limit: 12 },
                    { name: "#5.5 Axle w/ stop (32209)", limit: 2 },
                    { name: "#6 Axle (3706)", limit: 16 },
                    { name: "#7 Axle (44294)", limit: 16 },
                    { name: "#8 Axle (3707)", limit: 8 },
                    { name: "#10 Axle (3737)", limit: 4 },
                    { name: "#12 Axle (3708)", limit: 2 }
                ],
                "è¿æ¥ä»¶ (Connectors)": [
                    { name: "#1 Angle Connector (32013)", limit: 12 },
                    { name: "#2 Angle Connector (32034)", limit: 4 },
                    { name: "#3 Angle Connector (32016)", limit: 4 },
                    { name: "#4 Angle Connector (32192)", limit: 4 },
                    { name: "#5 Angle Connector (32015)", limit: 4 },
                    { name: "#6 Angle Connector (32014)", limit: 8 },
                    { name: "Axle Joiner Inline Smooth (6538c)", limit: 32 },
                    { name: "Axle Connector Double Rubber (45590)", limit: 8 },
                    { name: "Axle Joiner Perpendicular (6536)", limit: 48 },
                    { name: "Axle Joiner Perpendicular 3 Long (32184)", limit: 8 },
                    { name: "Axle Joiner Perpendicular Double (32291)", limit: 8 },
                    { name: "Axle Joiner Perpendicular Double Split (41678)", limit: 6 },
                    { name: "Axle Joiner Perpendicular Triple (63869)", limit: 8 },
                    { name: "Axle Joiner Perpendicular w/ 2 Holes (42003)", limit: 12 },
                    { name: "Bionicle Tooth (x346)", limit: 8 },
                    { name: "Pin Connector (62462)", limit: 4 },
                    { name: "Pin Connector Perpendicular Double 3 Long (32557)", limit: 8 },
                    { name: "Pin Connector Perpendicular 2 x 2 Bent (44809)", limit: 4 },
                    { name: "Pole Reverser (6553)", limit: 4 },
                    { name: "Axle Connector w/ Axle Hole (32039)", limit: 4 },
                    { name: "Axle Connector Hub w/ 3 Axles (57585)", limit: 2 }
                ],
                "ä¸¾å‡è‡‚ - åš (Liftarms Thick)": [
                    { name: "1 x 2 Liftarm w/ Axle Hole (60483)", limit: 8 },
                    { name: "1 x 3 Liftarm (32523)", limit: 16 },
                    { name: "1 x 5 Liftarm (32316)", limit: 11 },
                    { name: "1 x 5 Liftarm Bent 2x4 (32140)", limit: 12 },
                    { name: "1 x 7 Liftarm (32524)", limit: 16 },
                    { name: "1 x 7 Liftarm Bent 4x4 (32348)", limit: 16 },
                    { name: "1 x 7 Liftarm Bent 3x5 (32526)", limit: 8 },
                    { name: "1 x 9 Liftarm (40490)", limit: 10 },
                    { name: "1 x 9 Liftarm Bent 3x7 (32271)", limit: 4 },
                    { name: "1 x 11 Liftarm (32525)", limit: 10 },
                    { name: "1 x 11.5 Liftarm Double Bent (32009)", limit: 6 },
                    { name: "1 x 13 Liftarm (41239)", limit: 10 },
                    { name: "1 x 15 Liftarm (32278)", limit: 14 }
                ],
                "é”€é’‰ (Pins)": [
                    { name: "Pin 1/2 (4274)", limit: 16 },
                    { name: "Pin 3/4 (32002)", limit: 16 },
                    { name: "Pin w/out Friction (3673)", limit: 25 },
                    { name: "Pin w/ Friction (2780)", limit: 122 },
                    { name: "Pin Long w/ Friction (6558)", limit: 40 },
                    { name: "Pin Long w/ out Friction (32556)", limit: 13 },
                    { name: "Pin w/ Friction 3 Long w/ Stop Bush (32054)", limit: 16 },
                    { name: "Pin w/ Towball (6628)", limit: 8 },
                    { name: "Axle w/ Towball (2736)", limit: 2 },
                    { name: "Axle Pin w/ Friction (43093)", limit: 80 },
                    { name: "Axle Pin w/ out Friction (3749)", limit: 20 },
                    { name: "Pin Connector Perpendicular 3 Long w/ 4 Pins (48989)", limit: 12 },
                    { name: "Pin Connector Perpendicular 3x3 Bent w/ 4 Pins (55615)", limit: 4 },
                    { name: "Pin Double w/ Axle Hole (32138)", limit: 4 }
                ],
                "é½¿è½® (Gears)": [
                    { name: "8 Tooth (3647)", limit: 8 },
                    { name: "12 Tooth Double Bevel (32270)", limit: 4 },
                    { name: "12 Tooth Single Bevel (6589)", limit: 3 },
                    { name: "16 Tooth (4019)", limit: 6 },
                    { name: "20 Tooth Double Bevel (32269)", limit: 12 },
                    { name: "24 Tooth (3648)", limit: 6 },
                    { name: "36 Tooth Double Bevel (32498)", limit: 2 },
                    { name: "40 Tooth (3649)", limit: 4 },
                    { name: "Bush 1/2 (4265c)", limit: 42 },
                    { name: "Bush (3713)", limit: 42 },
                    { name: "Cam (6575)", limit: 2 },
                    { name: "Differential (6573)", limit: 1 },
                    { name: "Gear Rack 1 x 4 (3743)", limit: 4 },
                    { name: "Knob Wheel (32072)", limit: 2 },
                    { name: "Pulley Wheel (4185)", limit: 4 },
                    { name: "Worm Gear (4716)", limit: 2 }
                ],
                "ä¸¾å‡è‡‚ - è–„ (Liftarms Thin)": [
                    { name: "1 x 3 Liftarm Thin (6632)", limit: 16 },
                    { name: "Triangle (2905)", limit: 4 }
                ],
                "æ¿ / ç“¦ç‰‡ (Plates/Tiles)": [
                    { name: "1 x 2 Tile (3069b)", limit: 4 },
                    { name: "1 x 2 Plate (3023)", limit: 8 },
                    { name: "1 x 4 Plate (3710)", limit: 4 },
                    { name: "1 x 6 Plate (3666)", limit: 4 },
                    { name: "1 x 8 Plate (3460)", limit: 4 },
                    { name: "2 x 2 Round Dish (2654)", limit: 2 },
                    { name: "2 x 2 Plate Round (4032b)", limit: 4 },
                    { name: "2 x 4 Plate w/ holes (3709b)", limit: 4 },
                    { name: "2 x 6 Plate w/ holes (32001)", limit: 4 },
                    { name: "2 x 8 Plate w/ holes (3738)", limit: 4 }
                ],
                "ç§¯æœ¨ (Bricks)": [
                    { name: "1 x 1 Cone (4589)", limit: 3 },
                    { name: "1 x 2 w/ axle hole (32064)", limit: 4 },
                    { name: "1 x 2 w/ Hole (3700)", limit: 4 },
                    { name: "1 x 4 w/ Holes (3701)", limit: 4 },
                    { name: "1 x 6 w/ Holes (3894)", limit: 2 },
                    { name: "1 x 8 w/ Holes (3702)", limit: 2 },
                    { name: "1 x 12 w/ Holes (3895)", limit: 2 },
                    { name: "1 x 14 w/ Holes (32018)", limit: 4 },
                    { name: "2 x 2 Round (3941)", limit: 2 }
                ],
                "è½®å­ (Wheels)": [
                    { name: "Wheel 30.4 x 20 (56145)", limit: 8 },
                    { name: "Technic Wedge Belt Wheel Tire (70162)", limit: 4 },
                    { name: "Tire 56 x 26 Balloon (55976)", limit: 2 },
                    { name: "Tire 43.2 x 22 ZR (44309)", limit: 2 }
                ]
            }
        };

        let currentKit = 'electronics';
        let partsUsage = {};
        let teamNumber = '';

        function initializeData() {
            const saved = localStorage.getItem('botballPartsUsage');
            if (saved) {
                partsUsage = JSON.parse(saved);
            }

            const savedTeam = localStorage.getItem('botballTeamNumber');
            if (savedTeam) {
                teamNumber = savedTeam;
                document.getElementById('teamNumber').value = teamNumber;
            }
        }

        function saveData() {
            localStorage.setItem('botballPartsUsage', JSON.stringify(partsUsage));
        }

        function saveTeamNumber() {
            teamNumber = document.getElementById('teamNumber').value;
            localStorage.setItem('botballTeamNumber', teamNumber);
        }

        function printReport() {
            // æ ‡è®°æ‰€æœ‰æœªä½¿ç”¨çš„é›¶ä»¶å’Œåˆ†ç±»
            document.querySelectorAll('.category').forEach(category => {
                const cards = category.querySelectorAll('.part-card');
                let allUnused = true;

                cards.forEach(card => {
                    const key = card.getAttribute('data-part');
                    const usage = partsUsage[key] || { robot1: 0, robot2: 0 };
                    const total = usage.robot1 + usage.robot2;

                    if (total === 0) {
                        card.classList.add('unused');
                    } else {
                        card.classList.remove('unused');
                        allUnused = false;
                    }
                });

                // å¦‚æœæ•´ä¸ªåˆ†ç±»éƒ½æœªä½¿ç”¨ï¼Œæ ‡è®°è¿™ä¸ªåˆ†ç±»
                if (allUnused) {
                    category.classList.add('all-unused');
                } else {
                    category.classList.remove('all-unused');
                }
            });

            // æ˜¾ç¤ºæ‰€æœ‰å¥—ä»¶æ ‡ç­¾é¡µå†…å®¹ä»¥ä¾¿æ‰“å°
            document.querySelectorAll('.kit-content').forEach(content => {
                content.classList.remove('hidden');
            });

            // æ‰“å°
            window.print();

            // æ‰“å°åæ¢å¤éšè—æœªæ¿€æ´»çš„æ ‡ç­¾é¡µ
            setTimeout(() => {
                document.querySelectorAll('.kit-content').forEach((content, index) => {
                    const kitNames = ['electronics', 'metal', 'lego'];
                    if (kitNames[index] !== currentKit) {
                        content.classList.add('hidden');
                    }
                });
            }, 100);
        }

        function getPartKey(kitName, partName) {
            return `${kitName}_${partName}`;
        }

        function renderKit(kitName) {
            const container = document.getElementById(`${kitName}Kit`);
            const kit = kitsData[kitName];
            let html = '';

            for (const [category, parts] of Object.entries(kit)) {
                html += `
                    <div class="category">
                        <div class="category-header">${category}</div>
                        <div class="parts-grid">
                `;

                parts.forEach(part => {
                    const key = getPartKey(kitName, part.name);
                    const usage = partsUsage[key] || { robot1: 0, robot2: 0 };
                    const total = usage.robot1 + usage.robot2;
                    const isOver = total > part.limit;
                    const bendableInfo = part.bendable ? ' (å¯å¼¯æ›²)' : '';

                    // åªåœ¨æœ‰å›¾ç‰‡æ—¶æ˜¾ç¤ºå›¾ç‰‡
                    const imageSection = part.image ? `
                        <div class="part-header">
                            <img src="${part.image}" alt="${part.name}" class="part-image">
                            <div class="part-details">
                                <div class="part-name">${part.name}</div>
                                <div class="part-info">å¥—ä»¶é™åˆ¶: ${part.limit}${bendableInfo}</div>
                            </div>
                        </div>
                    ` : `
                        <div class="part-name">${part.name}</div>
                        <div class="part-info">å¥—ä»¶é™åˆ¶: ${part.limit}${bendableInfo}</div>
                    `;

                    html += `
                        <div class="part-card ${isOver ? 'over-limit' : ''}" data-part="${key}">
                            ${imageSection}
                            <div class="robot-inputs">
                                <div class="input-group">
                                    <label>æœºå™¨äºº 1</label>
                                    <div class="number-control">
                                        <button class="btn-number" onclick="changeValue('${key}', 'robot1', -1, ${part.limit})">-</button>
                                        <input type="number" min="0" value="${usage.robot1}" id="${key}_robot1"
                                               onchange="updatePart('${key}', 'robot1', this.value, ${part.limit})">
                                        <button class="btn-number" onclick="changeValue('${key}', 'robot1', 1, ${part.limit})">+</button>
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label>æœºå™¨äºº 2</label>
                                    <div class="number-control">
                                        <button class="btn-number" onclick="changeValue('${key}', 'robot2', -1, ${part.limit})">-</button>
                                        <input type="number" min="0" value="${usage.robot2}" id="${key}_robot2"
                                               onchange="updatePart('${key}', 'robot2', this.value, ${part.limit})">
                                        <button class="btn-number" onclick="changeValue('${key}', 'robot2', 1, ${part.limit})">+</button>
                                    </div>
                                </div>
                            </div>
                            <div class="usage-info ${isOver ? 'over' : ''}">
                                <span>å·²ç”¨: ${total}</span>
                                <span>å‰©ä½™: ${part.limit - total}</span>
                            </div>
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function updatePart(key, robot, value, limit) {
            if (!partsUsage[key]) {
                partsUsage[key] = { robot1: 0, robot2: 0 };
            }
            partsUsage[key][robot] = parseInt(value) || 0;
            saveData();
            updateSummary();
            updatePartCard(key, limit);
        }

        function changeValue(key, robot, delta, limit) {
            if (!partsUsage[key]) {
                partsUsage[key] = { robot1: 0, robot2: 0 };
            }
            const currentValue = partsUsage[key][robot] || 0;
            const newValue = Math.max(0, currentValue + delta);

            partsUsage[key][robot] = newValue;

            // æ›´æ–°è¾“å…¥æ¡†æ˜¾ç¤º
            const input = document.getElementById(`${key}_${robot}`);
            if (input) {
                input.value = newValue;
            }

            saveData();
            updateSummary();
            updatePartCard(key, limit);
        }

        function updatePartCard(key, limit) {
            const card = document.querySelector(`[data-part="${key}"]`);
            if (!card) return;

            const usage = partsUsage[key] || { robot1: 0, robot2: 0 };
            const total = usage.robot1 + usage.robot2;
            const isOver = total > limit;

            card.classList.toggle('over-limit', isOver);
            const usageInfo = card.querySelector('.usage-info');
            usageInfo.classList.toggle('over', isOver);
            usageInfo.innerHTML = `
                <span>å·²ç”¨: ${total}</span>
                <span>å‰©ä½™: ${limit - total}</span>
            `;
        }

        function updateSummary() {
            const kit = kitsData[currentKit];
            let totalParts = 0;
            let usedParts = 0;
            let overLimitParts = 0;

            for (const [category, parts] of Object.entries(kit)) {
                parts.forEach(part => {
                    totalParts++;
                    const key = getPartKey(currentKit, part.name);
                    const usage = partsUsage[key] || { robot1: 0, robot2: 0 };
                    const total = usage.robot1 + usage.robot2;

                    if (total > 0) usedParts++;
                    if (total > part.limit) overLimitParts++;
                });
            }

            document.getElementById('totalParts').textContent = totalParts;
            document.getElementById('usedParts').textContent = usedParts;
            document.getElementById('overLimitParts').textContent = overLimitParts;
        }

        function switchKit(kitName) {
            currentKit = kitName;

            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // æ¸…é™¤æœç´¢
            document.getElementById('searchBox').value = '';

            // æ¸…é™¤æ‰€æœ‰æœç´¢æ ‡è®°
            document.querySelectorAll('.search-result-badge').forEach(badge => {
                badge.remove();
            });

            document.querySelectorAll('.kit-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${kitName}Kit`).classList.remove('hidden');

            // æ˜¾ç¤ºæ‰€æœ‰é›¶ä»¶
            document.querySelectorAll('.part-card').forEach(card => {
                card.style.display = '';
            });

            updateSummary();
        }

        function searchParts() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            document.querySelectorAll('.part-card').forEach(card => {
                const partName = card.querySelector('.part-name').textContent.toLowerCase();
                card.style.display = partName.includes(searchTerm) ? '' : 'none';
            });
        }

        function searchAllKits() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase().trim();

            if (!searchTerm) {
                // å¦‚æœæœç´¢æ¡†ä¸ºç©ºï¼Œåªæ˜¾ç¤ºå½“å‰å¥—ä»¶
                document.querySelectorAll('.kit-content').forEach((content, index) => {
                    const kitNames = ['electronics', 'metal', 'lego'];
                    if (kitNames[index] === currentKit) {
                        content.classList.remove('hidden');
                        content.querySelectorAll('.part-card').forEach(card => {
                            card.style.display = '';
                            // ç§»é™¤æœç´¢æ ‡è®°
                            const badge = card.querySelector('.search-result-badge');
                            if (badge) badge.remove();
                        });
                    } else {
                        content.classList.add('hidden');
                    }
                });
                return;
            }

            // æœç´¢æ‰€æœ‰å¥—ä»¶
            let foundInKits = [];
            document.querySelectorAll('.kit-content').forEach((content, index) => {
                const kitNames = ['electronics', 'metal', 'lego'];
                const kitName = kitNames[index];
                let hasMatches = false;

                content.querySelectorAll('.part-card').forEach(card => {
                    const partName = card.querySelector('.part-name').textContent.toLowerCase();

                    if (partName.includes(searchTerm)) {
                        card.style.display = '';
                        hasMatches = true;

                        // ç§»é™¤æ—§çš„æ ‡è®°
                        const oldBadge = card.querySelector('.search-result-badge');
                        if (oldBadge) oldBadge.remove();

                        // æ·»åŠ å¥—ä»¶æ ‡è®°
                        const kitLabels = {
                            'electronics': 'ç”µå­',
                            'metal': 'é‡‘å±',
                            'lego': 'ä¹é«˜'
                        };
                        const badge = document.createElement('span');
                        badge.className = 'search-result-badge';
                        badge.textContent = kitLabels[kitName];
                        const partNameEl = card.querySelector('.part-name');
                        partNameEl.appendChild(badge);
                    } else {
                        card.style.display = 'none';
                        // ç§»é™¤æ ‡è®°
                        const badge = card.querySelector('.search-result-badge');
                        if (badge) badge.remove();
                    }
                });

                if (hasMatches) {
                    content.classList.remove('hidden');
                    foundInKits.push(kitName);
                } else {
                    content.classList.add('hidden');
                }
            });

            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•ç»“æœï¼Œæ˜¾ç¤ºå½“å‰å¥—ä»¶
            if (foundInKits.length === 0) {
                document.getElementById(`${currentKit}Kit`).classList.remove('hidden');
            }
        }

        function togglePDFLinks() {
            const pdfLinks = document.getElementById('pdfLinks');
            pdfLinks.classList.toggle('hidden');
        }

        function exportData() {
            const exportObj = {
                teamNumber: teamNumber,
                partsUsage: partsUsage,
                exportDate: new Date().toISOString()
            };
            const dataStr = JSON.stringify(exportObj, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const filename = teamNumber ?
                `botball_team_${teamNumber}_${new Date().toISOString().split('T')[0]}.json` :
                `botball_parts_${new Date().toISOString().split('T')[0]}.json`;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importData() {
            document.getElementById('fileInput').click();
        }

        function resetAll() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼')) {
                partsUsage = {};
                teamNumber = '';
                document.getElementById('teamNumber').value = '';
                saveData();
                localStorage.removeItem('botballTeamNumber');
                renderKit(currentKit);
                updateSummary();
            }
        }

        function clearCurrentKit() {
            const kitNames = {
                'electronics': 'ç”µå­å¥—ä»¶',
                'metal': 'é‡‘å±é›¶ä»¶',
                'lego': 'ä¹é«˜é›¶ä»¶'
            };
            const kitName = kitNames[currentKit] || currentKit;

            if (confirm(`ç¡®å®šè¦æ¸…ç©º"${kitName}"çš„æ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼`)) {
                const kit = kitsData[currentKit];

                // æ¸…ç©ºå½“å‰å¥—ä»¶çš„æ‰€æœ‰é›¶ä»¶æ•°æ®
                for (const [category, parts] of Object.entries(kit)) {
                    parts.forEach(part => {
                        const key = getPartKey(currentKit, part.name);
                        if (partsUsage[key]) {
                            delete partsUsage[key];
                        }
                    });
                }

                saveData();
                renderKit(currentKit);
                updateSummary();
            }
        }

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);

                    // å…¼å®¹æ–°æ—§æ ¼å¼
                    if (data.partsUsage && data.teamNumber !== undefined) {
                        // æ–°æ ¼å¼
                        partsUsage = data.partsUsage;
                        teamNumber = data.teamNumber;
                        document.getElementById('teamNumber').value = teamNumber;
                        localStorage.setItem('botballTeamNumber', teamNumber);
                    } else {
                        // æ—§æ ¼å¼
                        partsUsage = data;
                    }

                    saveData();
                    renderKit(currentKit);
                    updateSummary();
                    alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼');
                } catch (err) {
                    alert('å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ ¼å¼é”™è¯¯');
                }
            };
            reader.readAsText(file);
        });

        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                const kitName = e.target.dataset.kit;
                switchKit(kitName);
            });
        });

        initializeData();
        Object.keys(kitsData).forEach(kitName => renderKit(kitName));
        updateSummary();
    </script>
</body>
</html>
